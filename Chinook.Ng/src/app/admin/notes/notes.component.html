<div class="row">
    <div class="col-md-3">
        <div class="row mt-2 mb-2">
            <div class="col-8">
                <h5>Kategoriler({{ countCategory }})</h5>
            </div>
            <div class="col-4">
                <dx-button icon="plus" stylingMode="outlined" class="float-right" (click)="addCategory()">
                </dx-button>
            </div>
        </div>
        <div class="row">
            <div class="col-12">
                <dx-data-grid [dataSource]="categories" [showBorders]="true" [showColumnHeaders]="true" [showColumnLines]="true" [showRowLines]="true" keyExpr="id" [focusedRowEnabled]="true" [(focusedRowKey)]="noteCategoryId" (onFocusedRowChanged)="onSelectRowNoteCategory($event)">
                    <dxi-column dataField="id" [width]="60" [allowFiltering]="false" [allowSorting]="false" cellTemplate="cellTemplate" caption=""></dxi-column>
                    <dxi-column caption="Adı" dataField="name"></dxi-column>
                    <div *dxTemplate="let data of 'cellTemplate'">
                        <dx-drop-down-button (onSelectionChanged)="onSelectNoteCategory($event,data)" stylingMode="text" [items]="noteCategorySettings" icon="preferences" displayExpr="text" keyExpr="value" [dropDownOptions]="{ width: '100px' }"></dx-drop-down-button>
                    </div>
                    <dxo-paging [pageSize]="5" [enabled]="true"></dxo-paging>
                    <dxo-filter-row [visible]="true"></dxo-filter-row>
                </dx-data-grid>
            </div>
        </div>

    </div>
    <div class="col-md-3">
        <div *ngIf="noteCategoryId">
            <div class="row mt-2 mb-2">
                <div class="col-8">
                    <h5>Notlar({{ countNote }})</h5>
                </div>
                <div class="col-4">
                    <dx-button *ngIf="noteCategoryId" stylingMode="outlined" icon="plus" class="float-right" (click)="addNote()">
                    </dx-button>
                </div>
            </div>

            <div class="row">
                <div class="col-12">
                    <dx-data-grid [(dataSource)]="notes" [showBorders]="true" [showColumnHeaders]="true" [showColumnLines]="true" [showRowLines]="true" keyExpr="id" [focusedRowEnabled]="true" [(focusedRowKey)]="noteId" (onFocusedRowChanged)="onSelectRowNote($event)">
                        <dxo-filter-row [visible]="true"></dxo-filter-row>
                        <dxo-paging [enabled]="true" pageSize="5"></dxo-paging>

                        <dxi-column dataField="id" [width]="60" [allowFiltering]="false" [allowSorting]="false" cellTemplate="cellTemplate" caption=""></dxi-column>
                        <dxi-column caption="Adı" dataField="title"></dxi-column>
                        <div *dxTemplate="let data of 'cellTemplate'">
                            <dx-drop-down-button (onSelectionChanged)="onSelectNote($event,data)" stylingMode="text" [items]="noteSettings" icon="preferences" displayExpr="text" keyExpr="value" [dropDownOptions]="{ width: '100px' }"></dx-drop-down-button>
                        </div>
                    </dx-data-grid>
                </div>
            </div>

        </div>
    </div>
    <div class="col-md-6">
        <div [hidden]="!visibleNoteDetail">
            <dx-validation-group>
                <div class="row mt-2 mb-2">
                    <div class="col-4">
                        <h5>{{ noteHeader }}</h5>
                    </div>
                    <div class="col-8">
                        <dx-button icon="save" stylingMode="outlined" [useSubmitBehavior]="true" class="float-right ml-2" (onClick)="saveNote($event)"></dx-button>
                        <dx-button icon="clearformat" stylingMode="outlined" class="float-right" (click)="noteClear()">
                        </dx-button>
                    </div>
                </div>
                <div class="row">
                    <div class="col-12">
                        <div class="form-group">
                            <label>Başlık</label>
                            <dx-text-box [(value)]="note.title">
                                <dx-validator>
                                    <dxi-validation-rule type="required" message="Başlık alanı zorunludur."></dxi-validation-rule>
                                </dx-validator>
                            </dx-text-box>
                        </div>
                        <div class="form-group">
                            <label>Açıklama</label>
                            <dx-html-editor [(value)]="note.description" [height]="400">
                                <dxo-toolbar [multiline]="true">
                                    <dxi-item formatName="undo"></dxi-item>
                                    <dxi-item formatName="redo"></dxi-item>
                                    <dxi-item formatName="separator"></dxi-item>
                                    <dxi-item formatName="size" [formatValues]="['8pt', '10pt', '12pt', '14pt', '18pt', '24pt', '36pt']">
                                    </dxi-item>
                                    <dxi-item formatName="font" [formatValues]="['Arial', 'Courier New', 'Georgia', 'Impact', 'Lucida Console', 'Tahoma', 'Times New Roman', 'Verdana']">
                                    </dxi-item>
                                    <dxi-item formatName="separator"></dxi-item>
                                    <dxi-item formatName="bold"></dxi-item>
                                    <dxi-item formatName="italic"></dxi-item>
                                    <dxi-item formatName="strike"></dxi-item>
                                    <dxi-item formatName="underline"></dxi-item>
                                    <dxi-item formatName="separator"></dxi-item>
                                    <dxi-item formatName="alignLeft"></dxi-item>
                                    <dxi-item formatName="alignCenter"></dxi-item>
                                    <dxi-item formatName="alignRight"></dxi-item>
                                    <dxi-item formatName="alignJustify"></dxi-item>
                                    <dxi-item formatName="separator"></dxi-item>
                                    <dxi-item formatName="orderedList"></dxi-item>
                                    <dxi-item formatName="bulletList"></dxi-item>
                                    <dxi-item formatName="separator"></dxi-item>
                                    <dxi-item formatName="header" [formatValues]="[false, 1, 2, 3, 4, 5]"></dxi-item>
                                    <dxi-item formatName="separator"></dxi-item>
                                    <dxi-item formatName="color"></dxi-item>
                                    <dxi-item formatName="background"></dxi-item>
                                    <dxi-item formatName="separator"></dxi-item>
                                    <dxi-item formatName="link"></dxi-item>
                                    <dxi-item formatName="image"></dxi-item>
                                    <dxi-item formatName="separator"></dxi-item>
                                    <dxi-item formatName="clear"></dxi-item>
                                    <dxi-item formatName="codeBlock"></dxi-item>
                                    <dxi-item formatName="blockquote"></dxi-item>
                                    <dxi-item formatName="separator"></dxi-item>
                                    <dxi-item formatName="insertTable"></dxi-item>
                                    <dxi-item formatName="deleteTable"></dxi-item>
                                    <dxi-item formatName="insertRowAbove"></dxi-item>
                                    <dxi-item formatName="insertRowBelow"></dxi-item>
                                    <dxi-item formatName="deleteRow"></dxi-item>
                                    <dxi-item formatName="insertColumnLeft"></dxi-item>
                                    <dxi-item formatName="insertColumnRight"></dxi-item>
                                    <dxi-item formatName="deleteColumn"></dxi-item>
                                </dxo-toolbar>
                                <dxo-media-resizing [enabled]=true>
                                </dxo-media-resizing>
                            </dx-html-editor>
                        </div>
                    </div>
                </div>
            </dx-validation-group>
        </div>
    </div>
</div>

<dx-popup [(visible)]="isCategoryVisible" [(width)]="screenWidth" [(title)]="titleCategory" height="auto">
    <div class="row">
        <div class="col-12">
            <dx-validation-group>
                <div class="form-group">
                    <label>Kategori Adı</label>
                    <dx-text-box [(value)]="noteCategory.name">
                        <dx-validator>
                            <dxi-validation-rule type="required" message="Kategori Adı giriniz."></dxi-validation-rule>
                        </dx-validator>
                    </dx-text-box>
                </div>
                <div class="form-group">
                    <dx-button class="float-right ml-2" [useSubmitBehavior]="true" text="Kaydet" type="default" (onClick)="saveCategory($event)"></dx-button>
                    <dx-button class="float-right" (onClick)="isCategoryVisible=false" text="Kapat"></dx-button>
                </div>
            </dx-validation-group>
        </div>
    </div>
</dx-popup>

<dx-popup [(visible)]="isMoveNoteVisible" [(width)]="screenWidth" title="Not Taşı" height="auto">
    <div class="row">
        <div class="col-12">
            <dx-validation-group>
                <div class="form-group">
                    <label>Kategori</label>
                    <dx-select-box [(value)]="selectMoveNoteId" displayExpr="name" valueExpr="id" [dataSource]="moveCategories" searchMode="contains" searchExpr="name" [searchEnabled]="true">
                        <dx-validator>
                            <dxi-validation-rule type="required" message="Kategori seçiniz"></dxi-validation-rule>
                        </dx-validator>
                    </dx-select-box>
                </div>
                <div class="form-group">
                    <dx-button class="float-right ml-2" [useSubmitBehavior]="true" text="Taşı" type="default" (onClick)="onMoveNote($event)"></dx-button>
                    <dx-button class="float-right" (onClick)="isMoveNoteVisible=false" text="Kapat"></dx-button>
                </div>
            </dx-validation-group>
        </div>
    </div>
</dx-popup>

<!--
<kendo-dialog
  [title]="titleCategory"
  *ngIf="isCategoryVisible"
  (close)="isCategoryVisible = false"
>
  <div class="row">
    <div class="col-12">
      <form class="k-form" [formGroup]="formCategory">
        <kendo-formfield>
          <kendo-label text="Kategori"></kendo-label>
          <input formControlName="name" kendoTextBox required maxlength="100" />
          <kendo-formerror>Kategori zorunludur!</kendo-formerror>
        </kendo-formfield>
      </form>
    </div>
  </div>

  <kendo-dialog-actions layout="normal">
    <button kendoButton (click)="isCategoryVisible = false">İptal</button>
    <button kendoButton (click)="saveCategory()" primary="true">Kaydet</button>
  </kendo-dialog-actions>
</kendo-dialog>

<kendo-dialog
  title="Not Taşı"
  *ngIf="isMoveNoteVisible"
  (close)="isMoveNoteVisible = false"
  [width]="this.screenWidth < 768 ? this.screenWidth : 450"
>
  <div class="row">
    <div class="col-12">
      <form class="k-form" [formGroup]="formMoveNote">
        <kendo-formfield>
          <kendo-label text="Kategori"></kendo-label>
          <kendo-combobox
            required
            formControlName="noteCategoryId"
            [data]="cmbCategories"
            [textField]="'name'"
            [valueField]="'id'"
            [filterable]="true"
            [valuePrimitive]="true"
            (filterChange)="filterCategory($event)"
            placeholder="Kategori seçiniz."
          >
          </kendo-combobox>
          <kendo-formerror>Kategori zorunludur!</kendo-formerror>
        </kendo-formfield>
      </form>
    </div>
  </div>

  <kendo-dialog-actions layout="normal">
    <button kendoButton (click)="isMoveNoteVisible = false">İptal</button>
    <button kendoButton (click)="moveNote()" primary="true">Kaydet</button>
  </kendo-dialog-actions>
</kendo-dialog> -->
